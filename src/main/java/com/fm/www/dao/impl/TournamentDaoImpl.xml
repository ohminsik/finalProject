<?xml version="1.0" encoding="UTF-8"?>
<!-- 마이바티스 3 Mapper DOCTYPE -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <!-- 매퍼 설정 -->
  <mapper namespace="com.fm.www.dao.face.TournamentDao">
  	
  	<!-- 대회 게시글 전체 수 -->
  	<select id="tournamentTotalCount" resultType="int" parameterType="String">
		SELECT COUNT(*) FROM congress
		
      	WHERE board_fg = 9
      	<choose>
       		 <when test="_parameter != null and !_parameter.equals('')">
           	AND CON_REGION Like '%' || #{region} || '%'
          </when>
       	</choose>
      
       
  	</select>
	
	<!-- 대회 페이징 리스트 처리 -->
	<select id="tournamentRegionGetList" parameterType="com.fm.www.util.Paging2" resultType="com.fm.www.dto.Tournament">
	 SELECT * FROM (
         SELECT rownum rnum, B.* FROM (
            	select bt.*, c.con_con_datee, c.con_con_dates, c.con_reg_datee, c.con_reg_dates, c.con_region from board_tb bt, congress c
            	WHERE 1=1
            	AND bt.board_div = 9
            	AND bt.board_no = c.board_no
            	<choose>
            		 <when test="#{word} != null and #{word} != '')">
		               AND c.CON_REGION like '%' || #{word} || '%'
		             </when>
            	</choose>
            	ORDER BY bt.board_no desc
        	 ) B
    	     ORDER BY rnum
	      ) R
    	WHERE rnum BETWEEN #{startNo} AND #{endNo}
	</select>
	
  </mapper>